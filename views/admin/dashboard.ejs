<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-blue: #1a73e8;
            --light-blue: #e8f0fe;
            --dark-blue: #0d47a1;
            --white: #ffffff;
            --light-gray: #f5f5f5;
            --text-dark: #333333;
            --text-light: #757575;
            --border-color: #e0e0e0;
            --return-color: #ea4335;
            --cancel-color: #fbbc04;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f9f9f9;
            color: var(--text-dark);
            margin-left: 250px;
            /* Space for sidebar */
            margin-top: 50px;
            /* Space for navbar */
            padding: 20px;
            min-height: 100vh;
            box-sizing: border-box;
        }

        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }

        
  #filterButtons .btn {
    transition: all 0.25s ease-in-out;
  }

  #filterButtons .btn:hover {
    transform: translateY(-2px);
  }

  .custom-inputs {
    transition: opacity 0.3s ease;
  }

  .custom-inputs input {
    border-radius: 10px;
  }

  #applyCustomFilter {
    transition: all 0.2s ease-in-out;
    border-radius: 10px;
  }

  #applyCustomFilter:hover {
    transform: scale(1.05);
  }

        .logo {
            text-align: center;
            padding: 20px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo h2 {
            font-weight: 600;
        }

        .nav-links {
            margin-top: 30px;
        }

        .nav-links li {
            list-style: none;
            margin-bottom: 5px;
        }

        .nav-links a {
            color: var(--white);
            text-decoration: none;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
        }

        .nav-links a:hover,
        .nav-links a.active {
            background: var(--dark-blue);
            border-left: 4px solid var(--white);
        }

        .nav-links i {
            margin-right: 10px;
            font-size: 18px;
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            padding: 20px;
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            background: var(--white);
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .header h1 {
            color: var(--primary-blue);
            font-weight: 600;
        }

        .user-info {
            display: flex;
            align-items: center;
        }

        .user-info img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
            object-fit: cover;
        }

        /* Summary Cards */
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: var(--white);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .summary-card {
            display: flex;
            flex-direction: column;
        }

        .summary-card h3 {
            color: var(--text-light);
            font-size: 14px;
            margin-bottom: 10px;
        }

        .summary-card .value {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: 5px;
        }

        .summary-card.returns .value {
            color: var(--return-color);
        }

        .summary-card.cancelled .value {
            color: var(--cancel-color);
        }

        .summary-card .change {
            font-size: 12px;
            color: green;
            display: flex;
            align-items: center;
        }

        .summary-card .change.down {
            color: red;
        }

        /* Filters Section */
        .filters {
            background: var(--white);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .filters h2 {
            color: var(--primary-blue);
            margin-bottom: 20px;
            font-size: 18px;
        }

        .filter-options {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-group label {
            font-size: 14px;
            margin-bottom: 5px;
            color: var(--text-light);
        }

        .filter-group select,
        .filter-group input {
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            width: 200px;
        }

        .date-range {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .date-range input {
            width: 150px;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: var(--primary-blue);
            color: var(--white);
        }

        .btn-primary:hover {
            background: var(--dark-blue);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--primary-blue);
            color: var(--primary-blue);
        }

        .btn-outline:hover {
            background: var(--light-blue);
        }

        /* Tabs */
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            color: var(--text-light);
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            color: var(--primary-blue);
            border-bottom: 3px solid var(--primary-blue);
        }

        /* Report Section */
        .report {
            background: var(--white);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .report-header h2 {
            color: var(--primary-blue);
            font-size: 18px;
        }

        .chart-container {
            height: 300px;
            margin-bottom: 30px;
        }

        .report-table {
            width: 100%;
            border-collapse: collapse;
        }

        .report-table th,
        .report-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .report-table th {
            background: var(--light-blue);
            color: var(--primary-blue);
            font-weight: 600;
        }

        .report-table tr:hover {
            background: var(--light-gray);
        }

        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-returned {
            background-color: rgba(234, 67, 53, 0.1);
            color: var(--return-color);
        }

        .status-cancelled {
            background-color: rgba(251, 188, 4, 0.1);
            color: var(--cancel-color);
        }

        /* Additional Charts Container */
        .additional-charts {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        /* Responsive Styles */
        @media (max-width: 992px) {
            body {
                margin-left: 0;
            }

            .dashboard-container {
                flex-direction: column;
            }

            .filter-options {
                flex-direction: column;
            }

            .date-range {
                flex-wrap: wrap;
            }

            .additional-charts {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .summary-cards {
                grid-template-columns: 1fr;
            }

            .header {
                flex-direction: column;
                align-items: flex-start;
            }

            .user-info {
                margin-top: 15px;
            }

            .action-buttons {
                flex-wrap: wrap;
            }
        }
    </style>
     <%- include('../../views/partials/admin/adminHeaders', {title: 'adminHeader-page' }) %>
        <%- include('../../views/partials/admin/adminSidebar', {title: 'adminSidebar-page' }) %>
</head>

<body>
   

            <div class="dashboard-container">
                <!-- Main Content -->
                <div class="main-content">
                    <!-- Header -->
                    <div class="header">
                        <h1>Sales Report Dashboard</h1>
                        <div class="user-info">
                            <img src="https://ui-avatars.com/api/?name=Admin+User&background=0D8ABC&color=fff"
                                alt="User">
                            <span>Admin User</span>
                        </div>
                    </div>

                    <!-- Filter Reports Section -->
<div class="text-center my-4">
  <h5 class="mb-3 fw-bold">Filter Reports</h5>

  <!-- Filter Buttons -->
  <div id="filterButtons" class="btn-group mb-3" role="group" aria-label="Report Filters">
    <button type="button" class="btn btn-outline-primary" data-filter="daily">Daily</button>
    <button type="button" class="btn btn-outline-primary" data-filter="weekly">Weekly</button>
    <button type="button" class="btn btn-outline-primary" data-filter="monthly">Monthly</button>
    <button type="button" class="btn btn-outline-primary" data-filter="yearly">Yearly</button>
    <button type="button" class="btn btn-outline-primary" data-filter="custom">Custom</button>
  </div>

  <!-- Custom Date Inputs -->
  <div id="customDateInputs" class="custom-inputs mt-3" style="display: none;">
    <div class="d-inline-flex align-items-center gap-2">
      <input type="date" id="startDate" class="form-control w-auto">
      <input type="date" id="endDate" class="form-control w-auto">
      <button id="applyCustomFilter" class="btn btn-success">Apply</button>
    </div>
  </div>
</div>

                    <div class="card filters">
                        <h2>Generate Sales Report</h2>
                        <div class="action-buttons">
                            <button id="salesReportPDF" class="btn btn-outline"><i class="fas fa-download"></i> Download
                                PDF</button>
                            <button id="salesReportExcel" class="btn btn-outline"><i class="fas fa-file-excel"></i>
                                Download Excel</button>
                        </div>
                    </div>

                    <!-- Summary Cards -->
                    <div class="summary-cards container">
                        <div class="row g-3">
                            <div class="col-12 col-md-6 col-lg-3 col-xl-3">
                                <div class="card summary-card text-center p-3">
                                    <h3>Total Orders</h3>
                                    <div class="value">
                                        <%= totalOrders %>
                                    </div>
                                </div>
                            </div>

                            <div class="col-12 col-md-6 col-lg-3 col-xl-3">
                                <div class="card summary-card text-center p-3">
                                    <h3>Overall Order Amount</h3>
                                    <div class="value">₹<%= totalAmount %>
                                    </div>
                                </div>
                            </div>

                            <div class="col-12 col-md-6 col-lg-3 col-xl-3">
                                <div class="card summary-card text-center p-3">
                                    <h3>Overall Discount</h3>
                                    <div class="value">₹<%= totalDiscound %>
                                    </div>
                                </div>
                            </div>

                            <div class="col-12 col-md-6 col-lg-3 col-xl-3">
                                <div class="card summary-card text-center p-3">
                                    <h3>Overall Customers</h3>
                                    <div class="value">
                                        <%= usersCount %>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>



                    <!-- Additional Charts for Top Selling Products and Categories -->
                    <div class="additional-charts">
                        <div class="card report">
                            <div class="report-header">
                                <h2>Top Selling Products</h2>
                            </div>
                            <div class="chart-container">

                                <% if (topProducts && topProducts.length> 0) { %>
                                    <canvas id="productsChart"></canvas>
                                    <% }else{ %>
                                        <p>No Data</p>
                                        <% } %>

                            </div>
                        </div>

                        <div class="card report">
                            <div class="report-header">
                                <h2>Sales by Category</h2>
                            </div>
                            <div class="chart-container">
                                <canvas id="categoriesChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Tabs -->
                    <!-- <div class="tabs">
                        <div class="tab active" data-tab="sales">Sales Report</div>
                        <div class="tab" data-tab="returns">Returns & Cancellations</div>
                    </div> -->

                    <!-- Sales Report Section -->
                    <div class="card report sales-report">
                        <div class="report-header">
                            <h2>Sales Report: August 2023</h2>
                            <div class="action-buttons">
                                <button class="btn btn-outline"><i class="fas fa-sync-alt"></i> Refresh</button>
                            </div>
                        </div>

                        <div class="chart-container">
                            <canvas id="salesChart"></canvas>
                        </div>

                        <% if(dailySales && dailySales.length> 0){ %>
                            <table class="report-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Orders</th>
                                        <th>Sales Amount</th>
                                        <th>Discounts</th>
                                        <th>Coupons</th>

                                    </tr>
                                </thead>
                                <% dailySales.forEach(element=> { %>
                                    <% if(element.totalOrders>0){ %>
                                        <tbody>
                                            <tr>
                                                <td>
                                                    <%= element._id %>
                                                </td>
                                                <td>
                                                    <%= element.totalOrders %>
                                                </td>
                                                <td>₹<%= element.totalSales %>
                                                </td>
                                                <td>₹<%= element.totalDiscount %>
                                                </td>
                                                <td>
                                                    <%= element.totalCouponCount %>
                                                </td>

                                            </tr>
                                        </tbody>
                                        <% } %>
                                            <% }); %>
                            </table>
                            <% }else {%>

                                <p>No Data</p>

                                <% } %>

                    </div>

                    <!-- Returns & Cancellations Section -->
                    <div class="card report returns-report" style="display: none;">
                        <div class="report-header">
                            <h2>Returns & Cancellations: August 2023</h2>
                            <div class="action-buttons">
                                <button class="btn btn-outline"><i class="fas fa-sync-alt"></i> Refresh</button>
                            </div>
                        </div>

                        <div class="chart-container">
                            <canvas id="returnsChart"></canvas>
                        </div>

                        <table class="report-table">
                            <thead>
                                <tr>
                                    <th>Order ID</th>
                                    <th>Date</th>
                                    <th>Customer</th>
                                    <th>Amount</th>
                                    <th>Type</th>
                                    <th>Reason</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>#ORD-2876</td>
                                    <td>Aug 3, 2023</td>
                                    <td>John Smith</td>
                                    <td>₹9,374</td>
                                    <td>Return</td>
                                    <td>Wrong size</td>
                                    <td><span class="status-badge status-returned">Returned</span></td>
                                </tr>
                                <tr>
                                    <td>#ORD-2871</td>
                                    <td>Aug 2, 2023</td>
                                    <td>Emma Johnson</td>
                                    <td>₹6,562</td>
                                    <td>Cancellation</td>
                                    <td>Changed mind</td>
                                    <td><span class="status-badge status-cancelled">Cancelled</span></td>
                                </tr>
                                <tr>
                                    <td>#ORD-2865</td>
                                    <td>Aug 1, 2023</td>
                                    <td>Michael Brown</td>
                                    <td>₹16,125</td>
                                    <td>Return</td>
                                    极
                                    <td>Defective product</td>
                                    <td><span class="status-badge status-returned">Returned</span></td>
                                </tr>
                                <tr>
                                    <td>#ORD-2859</td>
                                    <td>Jul 30, 2023</td>
                                    <td>Sarah Wilson</td>
                                    <td>₹3,749</td>
                                    <td>Cancellation</td>
                                    <td>Found better price</td>
                                    <td><span class="status-badge status-cancelled">Cancelled</span></td>
                                </tr>
                                <tr>
                                    <td>#ORD-2852</td>
                                    <td>Jul 28, 2023</td>
                                    <td>David Miller</td>
                                    <td>₹13,499</td>
                                    <td>Return</td>
                                    <td>Not as described</td>
                                    <td><span class="status-badge status-returned">Returned</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
            <script>

                // Initialize the sales chart
                document.addEventListener('DOMContentLoaded', function () {

                  <% if (topProducts && topProducts.length > 0) { %>
                        console.log('if condition is working for top products');
                        const productsCtx = document.getElementById('productsChart').getContext('2d');

                        const productsChart = new Chart(productsCtx, {
                            type: 'bar',
                            data: {
                                labels: <%- JSON.stringify(topProducts.map((p) => p.productName)) %>,
                                datasets: [
                                    {
                                        label: 'Units Sold',
                                        data: <%- JSON.stringify(topProducts.map((p) => p.totalSold)) %>,
                                        backgroundColor: 'rgba(54, 162, 235, 0.7)',
                                        borderColor: 'rgba(54, 162, 235, 1)',
                                        borderWidth: 1,
                                        yAxisID: 'y'
                                    },
                                    {
                                        label: 'Revenue',
                                        data: <%- JSON.stringify(topProducts.map((p) => p.totalRevenue)) %>,
                                        backgroundColor: 'rgba(255, 159, 64, 0.7)',
                                        borderColor: 'rgba(255, 159, 64, 1)',
                                        borderWidth: 1,
                                        yAxisID: 'y1'
                                    }
                                ]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    title: {
                                        display: true,
                                        text: 'Top Selling Products (Units vs Revenue)',
                                        font: { size: 16 }
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        title: { display: true, text: 'Units Sold' }
                                    },
                                    y1: {
                                        beginAtZero: true,
                                        position: 'right',
                                        grid: { drawOnChartArea: false },
                                        title: { display: true, text: 'Revenue (₹)' }
                                    }
                                }
                            }
                        });
<% } else { %>
                        console.log('No top products found');
<% } %>

                    // Sales by Category Chart
                    <% if (topCategory && topCategory.length > 0) { %>
const categoriesCtx = document.getElementById('categoriesChart').getContext('2d');

                        const categoriesChart = new Chart(categoriesCtx, {
                            type: 'doughnut',
                            data: {
                                labels: <%- JSON.stringify(topCategory.map((c) => c.categoryName)) %>,
                                datasets: [{
                                    label: 'Total Sold',
                                    data: <%- JSON.stringify(topCategory.map((c) => c.totalSold)) %>,
                                    backgroundColor: [
                                        'rgba(54, 162, 235, 0.7)',
                                        'rgba(255, 99, 132, 0.7)',
                                        'rgba(255, 206, 86, 0.7)',
                                        'rgba(75, 192, 192, 0.7)',
                                        'rgba(153, 102, 255, 0.7)'
                                    ],
                                    borderColor: [
                                        'rgba(54, 162, 235, 1)',
                                        'rgba(255, 99, 132, 1)',
                                        'rgba(255, 206, 86, 1)',
                                        'rgba(75, 192, 192, 1)',
                                        'rgba(153, 102, 255, 1)'
                                    ],
                                    borderWidth: 1
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    title: {
                                        display: true,
                                        text: 'Sales Distribution by Category',
                                        font: { size: 16 }
                                    },
                                    tooltip: {
                                        callbacks: {
                                            label: function (context) {
                                                const index = context.dataIndex;
                                                const sold = context.raw.toLocaleString('en-IN');
                                                const revenue = <%- JSON.stringify(topCategory.map((c) => c.totalRevenue)) %> [index].toLocaleString('en-IN');
                                                return `Sold: ${sold} | Revenue: ₹${revenue}`;
                                            }
                                        }
                                    }
                                }
                            }
                        })
                            <% } %>




                    // Sales Chart
                      <% if (dailySales && dailySales.length > 0) { %>
                      const dailySalesData = <%- JSON.stringify(dailySales) %>;
                        const ctx = document.getElementById('salesChart').getContext('2d');

                        const salesChart = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: dailySalesData.map(d => d._id),
                                datasets: [{
                                    label: 'Sales Amount (₹)',
                                    data: dailySalesData.map(d => d.totalSales),
                                    borderColor: '#1a73e8',
                                    backgroundColor: 'rgba(26, 115, 232, 0.1)',
                                    tension: 0.4,
                                    fill: true
                                }, {
                                    label: 'Discounts (₹)',
                                    data: dailySalesData.map(d => d.totalDiscount),
                                    borderColor: '#ea4335',
                                    backgroundColor: 'rgba(234, 67, 53, 0.1)',
                                    tension: 0.4,
                                    fill: true
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    title: { display: true, text: 'Sales Performance', font: { size: 16 } },
                                    tooltip: {
                                        mode: 'index',
                                        intersect: false,
                                        callbacks: {
                                            label: function (context) {
                                                return context.dataset.label + ': ₹' + context.raw.toLocaleString('en-IN');
                                            }
                                        }
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        ticks: {
                                            callback: function (value) { return '₹' + value.toLocaleString('en-IN'); }
                                        }
                                    }
                                }
                            }
                        });
  <% } %>

                        // Returns Chart
                        // const returnsCtx = document.getElementById('returnsChart').getContext('2d');
                        // const returnsChart = new Chart(returnsCtx, {
                        //     type: 'bar',
                        //     data: {
                        //         labels: ['Aug 1', 'Aug 2', 'Aug 3', 'Aug 4', 'Aug 5', 'Aug 6', 'Aug 7'],
                        //         datasets: [{
                        //             label: 'Returns',
                        //             data: [3, 2, 5, 1, 4, 2, 3],
                        //             backgroundColor: 'rgba(234, 67, 53, 0.7)',
                        //         }, {
                        //             label: 'Cancellations',
                        //             data: [2, 3, 1, 2, 3, 1, 2],
                        //             backgroundColor: 'rgba(251, 188, 4, 0.7)',
                        //         }]
                        //     },
                        //     options: {
                        //         responsive: true,
                        //         maintainAspectRatio: false,
                        //         plugins: {
                        //             title: {
                        //                 display: true,
                        //                 text: 'Returns & Cancellations (August 2023)',
                        //                 font: {
                        //                     size: 16
                        //                 }
                        //             },
                        //             tooltip: {
                        //                 mode: 'index',
                        //                 intersect: false
                        //             }
                        //         },
                        //         scales: {
                        //             y: {
                        //                 beginAtZero: true,
                        //                 title: {
                        //                     display: true,
                        //                     text: 'Number of Orders'
                        //                 }
                        //             }
                        //         }
                        //     }
                        // });

                        // Top Selling Products Chart

                        // Handle report type change
          
          
          
                        document.getElementById('report-type').addEventListener('change', function () {
                            const reportType = this.value;
                            const dateRange = document.querySelector('.date-range');

                            if (reportType === 'custom') {
                                dateRange.style.display = 'flex';
                            } else {
                                dateRange.style.display = 'none';
                            }
                        });

                    // Tab functionality - FIXED
                    const tabs = document.querySelectorAll('.tab');
                    tabs.forEach(tab => {
                        tab.addEventListener('click', () => {
                            // Remove active class from all tabs
                            tabs.forEach(t => t.classList.remove('active'));

                            // Add active class to clicked tab
                            tab.classList.add('active');

                            // Hide only the sales and returns reports, not the additional charts
                            document.querySelector('.sales-report').style.display = 'none';
                            document.querySelector('.returns-report').style.display = 'none';

                            // Show the selected report
                            const tabName = tab.getAttribute('data-tab');
                            if (tabName === 'sales') {
                                document.querySelector('.sales-report').style.display = 'block';
                            } else if (tabName === 'returns') {
                                document.querySelector('.returns-report').style.display = 'block';
                            }
                        });
                    });

                    // Initialize date inputs with current date
                    const today = new Date();
                    const sevenDaysAgo = new Date();
                    sevenDaysAgo.setDate(today.getDate() - 7);

                    document.getElementById('start-date').valueAsDate = sevenDaysAgo;
                    document.getElementById('end-date').valueAsDate = today;
                })


  const filterButtons = document.querySelectorAll('#filterButtons button');
  const customDateInputs = document.getElementById('customDateInputs');
  const applyButton = document.getElementById('applyCustomFilter');
let filterDate
  // Handle filter button clicks
  filterButtons.forEach(button => {
    button.addEventListener('click', () => {
        filterDate = button.dataset.filter
        
      // Remove active class from all
      filterButtons.forEach(btn => btn.classList.remove('btn-primary', 'text-white'));
      filterButtons.forEach(btn => btn.classList.add('btn-outline-primary'));

      // Activate clicked one
      button.classList.remove('btn-outline-primary');
      button.classList.add('btn-primary', 'text-white');

      // Show or hide custom date section
      if (button.dataset.filter === 'custom') {
        customDateInputs.style.display = 'block';
        customDateInputs.style.opacity = 0;
        setTimeout(() => {
          customDateInputs.style.opacity = 1;
          customDateInputs.style.transition = 'opacity 0.3s ease';
        }, 50);
      } else {
        fetchTheFilterData(filterDate)
        customDateInputs.style.opacity = 0;
        setTimeout(() => (customDateInputs.style.display = 'none'), 300);
      }
    });
  });

  // Handle Apply Button click (currently just logs)
  applyButton.addEventListener('click', () => {
    const startDate = document.getElementById('startDate').value;
    const endDate = document.getElementById('endDate').value;

    if (!startDate || !endDate) {
      alert('Please select both start and end dates.');
      return;
    }
    fetchTheFilterData(startDate,endDate)

  })

   function fetchTheFilterData(...date) {
    window.location.href=`/admin/dashboard?date=${encodeURIComponent(date)}`

  }



                document.getElementById('salesReportPDF').addEventListener('click', () => {
                    window.location.href = `/admin/generate-pdf?date=${encodeURIComponent(filterDate)}`
                })

                  document.getElementById('salesReportExcel').addEventListener('click', () => {
                    window.location.href = `/admin/salesReportExcel?date=${encodeURIComponent(filterDate)}`
                });

            
            </script>
</body>

</html>